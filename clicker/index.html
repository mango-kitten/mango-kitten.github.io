<!DOCTYPE html>
<html>
  <head>
    <title>MangoKitten Clicker</title>
      <link rel="stylesheet" href="../style.css">
      <link rel="preconnect" href="https://fonts.googleapis.com">
      <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      <link href="https://fonts.googleapis.com/css2?family=Playpen+Sans&display=swap" rel="stylesheet">
      <link rel="icon" type="image/x-icon" href="../img/favicon.ico">
  </head>
  <body onload="autoload()">
    <header>
      <p class="spacer">&#10240</p>
      <h1>MangoKitten</h1>
      <p class="spacer">&#10240</p>
    </header>
    <main>
      <script>
        let dolor = parseInt(localStorage.getItem("money"));
        let mpc = 1;
        let bought = [0, 0, 0, 0];
        let costs = [2000, 50, 100, 2000];
        let itemprice = 0;
        let itemflag = 0;
        if (!dolor) {
          dolor = 0;
          console.log("No save file found, starting fresh.")
        }
        function autoload() {
          document.getElementById("moneydisp").innerHTML = `Money: ${String(dolor)}`
          console.log("Loaded")
        }
        function money() {
          dolor = dolor + mpc
          document.getElementById("moneydisp").innerHTML = `Money: ${String(dolor)}`
        }
        function localsave() {
          localStorage.setItem("money", dolor);
          var now = new Date();
          var datetime = now.toLocaleString();
          document.getElementById("lastsaved").innerHTML = `Last Saved: ${String(datetime)}`
          console.log("Saved")
        }
        function localload() {
          let dolor = parseInt(localStorage.getItem("money"));
          document.getElementById("moneydisp").innerHTML = `Money: ${String(dolor)}`
          console.log("Loaded")
        }
        function resetstorage() {
          dolor = 0;
          localStorage.removeItem("money");
        }
        function buyitem(id) {
          itemprice = costs[id];
          if (id == 0) {
            itemflag = bought[0];
            if (itemflag == 0) {
              if (dolor >= itemprice) {
                // buy the item
                dolor = dolor - itemprice;
                document.getElementById("moneydisp").innerHTML = `Money: ${String(dolor)}`
                document.getElementById("money").innerHTML = "Get Money 🐈"
                bought.splice(0, 1, 1)
              } else {
                // too poor
                document.getElementById("clickerinfo").innerHTML = "You're too poor!"
              };
            } else {
              // already owned
              document.getElementById("clickerinfo").innerHTML = "You already own this item!"
            };
            if (dolor >= itemprice) {
              dolor = dolor-itemprice;
              document.getElementById("moneydisp").innerHTML = `Money: ${String(dolor)}`
              mpc = mpc+0.5
              // bought item
            } else {
              // too poor
              document.getElementById("clickerinfo").innerHTML = "You're too poor!"
            };
          };
        }
        
        setInterval(function() {
          localStorage.setItem("money", dolor);
          var now = new Date();
          var datetime = now.toLocaleString();
          document.getElementById("lastsaved").innerHTML = `Last Saved: ${String(datetime)}`
          console.log("Auto-saved")
        }, 60 * 1000);
      </script>
      <div class="spacer">
        <p>&#10240</p>
      </div>
      <p id="clickertopbar">Mangos Clicker Game v0.2</p>
      <p id=clickerinfo">&#10240</p>
      <h2 id="moneydisp">Money: 0</h2>
      <button onclick="money()" class="moneybutton" id="money">Get Money</button>
      <button onclick="localsave()" class="savebutton">Save</button>
      <button onclick="localload()" class="savebutton">Load</button>
      <button onclick="resetstorage()" class="savebutton">Reset</button>
      <p id="lastsaved">Last Saved: Not saved this session.</p>
      <button onclick="buyitem(0)" class="moneybutton">Buy a Cat $2000</button>
      <button onclick="buyitem(1)" class="moneybutton">Increase mpc $50</button>
    </main>
    <footer>
      <a href="https://www.youtube.com/@mangokittengaming">YouTube</a>
      <a href="https://www.twitch.tv/mangokittengaming">Twitch</a>
      <a href="https://steamcommunity.com/profiles/76561199415611477/">Steam</a>
    </footer>
  </body>
</html>
